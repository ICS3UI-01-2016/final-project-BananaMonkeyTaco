on *:join:%channel: {
  if ($nick == bananamtbot || $nick == revlobot || $nick == nightbot) {
    return
  }
  else {
    $+(timerpoints.,$nick) 0 60 regularPoints $nick
    $+(timerleaderboard.,$nick) 0 60 leaderboardPoints $nick
    echo 12 -at $nick joined and is receiving %points
  }
}
on *:part:%channel:{
  $+(timerpoints.,$nick) off
  $+(timerleaderboard.,$nick) off
  echo 12 -at $nick has left and is no long receiving %points
}
alias -l regularPoints {
  writeini -n %ini %points $1 $calc($readini(%ini,%points,$1)+1)
}
alias -l leaderboardPoints {
  writeini -n Leaderboard.ini %points $1 $calc($readini(Leaderboard.ini,%points,$1)+1)
}
alias -l cancelduel {
  msg %channel %duelee has run out of time to accept the challenge from %dueler and must now live in extreme shame.
  %dueler = null
  %duelee = null
  %stakes = null
}
alias inisort {
  window @sortPointsIn
  window @sortPointsOut
  window @sortLeaderboardIn
  window @sortLeaderboardOut
  loadbuf -t @sortPointsIn Bananas.ini
  filter -cteu 2 61 @sortPointsIn @sortPointsOut
  loadbuf -t @sortLeaderboardIn Leaderboard.ini
  filter -cteu 2 61 @sortLeaderboardIn @sortLeaderboardOut
  iline @sortPointsOut 1 [Bananas]
  iline @sortLeaderboardOut 1 [Bananas]
  remini Bananas.ini Bananas
  savebuf -a @sortPointsOut Bananas.ini
  remini Leaderboard.ini Bananas
  savebuf -a @sortLeaderboardOut Leaderboard.ini
  window -c @sortPointsIn
  window -c @sortPointsOut
  window -c @sortLeaderboardIn
  window -c @sortLeaderboardOut
}
on *:text:!bananas:%channel: {
  msg $chan $nick has $readini(Bananas.ini,%points,$nick) %points.
  echo 12 -t $nick requested amount of %points
}
on *:text:!givebananas:%channel: {
  if ($nick isop %channel) {
    if ($0 == 3) {
      if ($3 isnum) {
        writeini -n Bananas.ini %points $2 $calc($readini(Bananas.ini,%points,$2)+ $3)
        msg $chan $2 has been given $3 %points.
      }
      else {
        msg $chan You must give a number to give.
      }
    }
    else if ($0 != 3) {
      msg $chan Error. Command requires 3 words. !givebananas, Name, Number of %points to give.
    }
  }
  else {
    msg $chan This command is for mods only.
  }
}
on *:text:!info:%channel: {
  msg $chan For information about me check out this Google Doc: https://docs.google.com/document/d/1qJfsyScG3XepkhOqKGcETzF7QLC9hV876QphGW2woU8/edit?usp=sharing
}
on *:text:!sort:%channel: {
  if ($nick == bananamonkeytaco) {
    $inisort
  }
}
on *:text:!gamble*:%channel: {
  if ($0 != 2) {
    msg $chan Error. Gamble command requires !gamble and a number.
  }
  else if ($2 > 1000) {
    msg $chan You cannot gamble more than 1000 %points.
  }
  else {
    %num = $rand(1,100)
    if (%num > 60) {
      msg $chan $nick has rolled %num and won $2 %points
      writeini -n Bananas.ini %points $nick $calc($readini(Bananas.ini,%points,$nick)+ $2)
    }
    else if (%num <= 60) {
      msg $chan $nick has rolled %num and lost $2 %points
      writeini -n Bananas.ini %points $nick $calc($readini(Bananas.ini,%points,$nick)- $2)
    }
  }
}
on *:text:!duel*:%channel: {
  if ($0 = 3) {
    if (%dueler == null) {
      if ($3 > 1000) {
        msg $chan Sorry but gambling over 1000 %points is not allowed.
      }
      else {
        msg $chan $nick has challenged $1 to a duel worth $3 %points ! $1 do you accept or decline this duel?
        %dueler = $nick
        %duelee = $2
        %stakes = $3
        timerduel 1 60 cancelduel
      }
    }
    else {
      msg $chan Sorry, but there is already a duel that has been started. Please wait until that duel expires before requesting another.
    }
  }
  else if ($0 != 3) {
    msg $chan Error. This command requires 3 words. !duel, Name, Number of %points to bet.
  }
}
on *:text:!accept:%channel: {
  if (%duelee == $nick) {
    timerduel off
    msg $chan %duelee has accepted the duel from %dueler for %stakes %points . It's time to ROLL!
    %duelerRoll = $rand(1,100)
    %dueleeRoll = $rand(1,100)
    writeini -n Bananas.ini %points %dueler $calc($readini(Bananas.ini,%points,%dueler)-%stakes)
    writeini -n Bananas.ini %points %duelee $calc($readini(Bananas.ini,%points,%duelee)-%stakes)
    msg $chan %dueler started the duel and rolls first. He rolls a %duelerRoll now let's wait and see what %duelee will roll.
    msg $chan %duelee rolls a $rand(1,100)
    if (%duelerRoll > %dueleeRoll) {
      msg $chan %dueler has won the duel and won $calc(%stakes * 2)
      writeini -n Bananas.ini %points %dueler $calc($readini(Bananas.ini,%points,%dueler)+$calc(%stakes * 2))
    }
    else if (%dueleeRoll > %duelerRoll) {
      msg $chan %duelee has won the duel and won $calc(%stakes * 2)
      writeini -n Bananas.ini %points %duelee $calc($readini(Bananas.ini,%points,%duelee)+$calc(%stakes * 2))
    } 
    else if (%dueleeRoll == %duelerRoll) {
      msg $chan Both %duelee and %dueler rolled %duelerrRoll so neither has won the duel.
      writeini -n Bananas.ini %points %dueler $calc($readini(Bananas.ini,%points,%dueler)+%stakes)
      writeini -n Bananas.ini %points %duelee $calc($readini(Bananas.ini,%points,%duelee)+%stakes)
    }
    %duelee = null
    %dueler = null
    %stakes = null
    %dueleeRoll = null
    %duelerRoll = null
  }
}
on *:text:!decline:%channel: {
  if (%duelee == $nick) {
    timerduel off
    msg $chan %duelee has declined the duel from %dueler and must live in dishonor forever.
    %duelee = null
    %dueler = null
    %stakes = null
  }
}
on *:text:!rank*:%channel: {
  if ($0 = 1) {
    window @rank
    loadbuf -t @rank Bananas.ini
    dline @rank 1
    filter -cnteu 2 61 @rank @rank
    filter -c @rank @rank $+(*,$nick,*)
    %rank = $gettok($line(@rank,1),1,32)
    window -c @rank
    msg $chan $nick is %rank on the leaderboard for current %points
  }
  else if ($0 = 2) {
    if ($2 !isnum) {
      window @rank
      loadbuf -t @rank Bananas.ini
      dline @rank 1
      filter -cnteu 2 61 @rank @rank
      filter -c @rank @rank $+(*,$2,*)
      %rank = $gettok($line(@rank,1),1,32)
      window -c @rank
      msg $chan $2 is %rank on the leaderboard for current %points.
    }
    else if ($2 isnum) {
      window @rank
      window @newrank
      loadbuf -t @rank Bananas.ini
      dline @rank 1
      filter -cnteu 2 61 @rank @newrank
      filter -cnteu 2 61 @rank @rank
      filter -c @rank @rank $+(*,$nick,*)
      %rank = $gettok($line(@rank,1),1,32)
      filter -cr $+($calc(%rank -5),-,$calc(%rank +5)) @newrank @rank
      msg $chan rank inbetweens $read(@rank) GGRRGTbrrbRBTREGRG error
    }
  }
  %rank = null
}
on *:text:!alltimerank*:%channel: {
  if ($0 = 1) {
    window @rank
    loadbuf -t @rank Leaderboard.ini
    dline @rank 1
    filter -cnteu 2 61 @rank @rank
    filter -c @rank @rank $+(*,$nick,*)
    %rank = $gettok($line(@rank,1),1,32)
    window -c @rank
    msg $chan $nick is %rank on the leaderboard for all time %points.
  }
  else if ($0 = 2) {
    if ($2 !isnum) {
      window @rank
      loadbuf -t @rank Leaderboard.ini
      dline @rank 1
      filter -cnteu 2 61 @rank @rank
      filter -c @rank @rank $+(*,$2,*)
      %rank = $gettok($line(@rank,1),1,32)
      window -c @rank
      msg $chan $2 is %rank on the leaderboard for all time %points.
    }
    else if ($2 isnum) {
      window @rank
      window @newrank
      loadbuf -t @rank Leaderboard.ini
      dline @rank 1
      filter -cnteu 2 61 @rank @newrank
      filter -cnteu 2 61 @rank @rank
      filter -c @rank @rank $+(*,$nick,*)
      %rank = $gettok($line(@rank,1),1,32)
      filter -cr $+($calc(%rank -5),-,$calc(%rank +5)) @newrank @rank
      msg $chan rank inbetweens $read(@rank) GGRRGTbrrbRBTREGRG error
    }
  }
  %rank = null
}
on *:text:!leaderboard:%channel: {
  window @leaderboard
  loadbuf -t @leaderboard Bananas.ini
  dline @leaderboard 1
  filter -cteu 2 61 @leaderboard @leaderboard
  msg $chan The top 5 people are: $line(@leaderboard,1) $line(@leaderboard,2) $line(@leaderboard,3) $line(@leaderboard,4) $line(@leaderboard,5)
  window -c @leaderboard
}
on *:text:!alltimeleaderboard:%channel: {
  window @leaderboard
  loadbuf -t @leaderboard Leaderboard.ini
  dline @leaderboard 1
  filter -cteu 2 61 @leaderboard @leaderboard
  msg $chan The top 5 people are: $line(@leaderboard,1) $line(@leaderboard,2) $line(@leaderboard,3) $line(@leaderboard,4) $line(@leaderboard,5)
  window -c @leaderboard
}
on *:text:!daytax:%channel: {
  if ($nick == bananamonkeytaco) {
    %temp = $lines(Bananas.ini)
    while (%temp > 1) {
      dec %temp
      writeini -n Bananas.ini %points $ini(Bananas.ini,1,%temp) $calc($readini(Bananas.ini,%points,$ini(Bananas.ini,1,%temp))-1)
      if ($readini(Bananas.ini,%points,$ini(Bananas.ini,1,%temp)) < 1) {
        remini -n Bananas.ini %points $ini(Bananas.ini,1,%temp)
      }
    }
    %temp = $lines(Leaderboard.ini)
    while (%temp > 1) {
      dec %temp
      writeini -n Leaderboard.ini %points $ini(Leaderboard.ini,1,%temp) $calc($readini(Leaderboard.ini,%points,$ini(Leaderboard.ini,1,%temp))-1)
      if ($readini(Leaderboard.ini,%points,$ini(Leaderboard.ini,1,%temp)) < 1) {
        remini -n Leaderboard.ini %points $ini(Leaderboard.ini,1,%temp)
      }
    }
  }
}
on *:text:!sr*:%channel: {
  timersong 1 10 msg $chan !sr $2-
  msg $chan Redeeming a SongRequest for $nick at the cost of 20 %points
  writeini -n Bananas.ini %points $nick $calc($readini(Bananas.ini,%points,$nick)-20)
}
on *:text:!songrequest*:%channel: {
  timersong 1 10 msg $chan !sr $2-
  msg $chan Redeeming a SongRequest for $nick at the cost of 20 %points.
  writeini -n Bananas.ini %points $nick $calc($readini(Bananas.ini,%points,$nick)-20)
}
on *:text:!discordreward:%channel: {
  if ($readini(Bananas.ini,%points,$nick) >= 300) {
    msg $chan /w $nick Use this link to join the discord: https://discord.gg/xC7zc6n Also make sure to say in the chat when you join so my master can allow you to speak in the Discord. Also note that I am not able to respond in any way
  }
  else {
    msg $chan I'm sorry, but you do not have the 300 %points needed to redeem this reward.
  }
}
on *:text:*nowabot*:%channel: {
  msg $chan Did someone say something about my dad?
}
on *:text:*moobot*:%channel: {
  msg $chan Did someone say moobot? Do you think I'm moobot? Are you trying to imply that I'm similar to that useless, filthy, garbage bot? How dare you.
}
on *:text:!yonder:%channel: {
  msg $chan ...
}
on *:text:!set:#bananamonkeytaco: {
  set %channel #bananamonkeytaco
  set %points Bananas
  set %ini $+(%points,.ini)
}
on *:text:something:#bananamonkeytaco: {
  msg $chan %channel
  msg $chan %ini
}
on *:text:*:#: {
  return
}
on *:text:youcannotsaythiseversecretlostcoding:#: {
  else if ($1 == !dst) {
    if ($nick isop #bananamonkeytaco) {
      if ($2 == add) {
        %players = $addtok($3,%players,44)
        msg $chan $3 has been added to the current players
      }
      else if ($2 == del) {
        if ($findtok(%players,$3,44) != 0) {
          %players = $remtok(%players,$3,0,44)
          msg $chan $3 has been removed from the players.
        }
        else {
          msg $chan $3 is not in the player list. Please check the list for the correct player you wish to remove
        }
        else if ($2 == reset) {
          %players = $deltok(%players,1-,44)
          msg $chan Players have been reset.
        }
      }
      if ($0 == 1) {
        if ($numtok(%players,44) == 0) {
          msg $chan There are no players for DST at the moment.
        }
        else if ($numtok(%players,44) > 0) {
          msg $chan The current players for DST are %players
        }
      }
      else if ($2 == buy) {
        if ($numtok(%players,44) == 6) {
          msg $chan I'm sorry, there are 6 players already which is the maxium. If still wish to play you may try and buy out a player.
        }
        else if ($0 == 3 && $numtok(%players,44) == 0) {
          msg $chan $nick is attempting to buy out $3 from the DST server. They will have 5 minutes to respond or they will be replaced.
          writeini -n Bananas.ini Bananas $nick $calc($readini(Bananas.ini,Bananas,$nick)-200)
          timerreplace 1 300 $replacePlayer $nick $3
        }
        else {
          msg $chan $nick has bought into the DST server for 100 bananas and has been added to the player list.
          %players = $addtok($3,%players,44)
          writeini -n Bananas.ini Bananas $nick $calc($readini(Bananas.ini,Bananas,$nick)-100)
        }
      }
    }
  }
}
on $*:text:/^(!sr*|!songrequest*)/si:#: {
  timersong 1 10 msg $chan !songrequest $2-
  msg $chan Redeeming a SongRequest for $nick at the cost of 20 bananas.
  writeini -n Bananas.ini Bananas $nick $calc($readini(Bananas.ini,Bananas,$nick)-20)
}
